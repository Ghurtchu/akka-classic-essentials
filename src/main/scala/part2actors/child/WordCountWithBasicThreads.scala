package part2actors.child

object WordCountWithBasicThreads extends scala.App {

  class WordCountMaster(texts: Array[String]) {

    private final var totalWordCount: Int = 0 // initialize as 0

    def execute(): Unit = {
      val tasks = for (txt <- texts) yield new WordCountTask(txt)
      val threads = for (task <- tasks) yield new Thread(task)
      threads.foreach(_.start())
      threads.foreach(_.join())
      totalWordCount = tasks.map(_.get).sum
    }

    def getTotal: Int = totalWordCount
  }

  class WordCountTask(sentence: String) extends Runnable {

    private var count: Int = 0

    override def run(): Unit = count += sentence.split(" ").length

    def get: Int = count
  }

  val arr = Array("კუზი ძაღლურმა ცხოვრებამ გამიჩინა!\nკეთილო ადამიანო, დაუყოვნებლივ გააზიარე ეს პოსტი! დაეხმარე შენს მეგობრებსაც მონაწილეობა მიიღონ ღვთისნიერ საქმეში!\nთუ დარდობ შენი ყოველდღიური პრობლემების გამო, უბრალოდ შეადარე ისინი ამ საბრალო, კეთილი მოხუცი ქალის ყოველდღიურობას!\n         „ნუ გეშინია, ზღაპრის გმირ საშინელ მოხუცებს კი ვგავარ, მაგრამ გულით ახალგაზრდა ვარ. იცი, ცხოვრებაში რამდენი ტკივილი და ტანჯვა მაქვს ნანახი? ჰოდა, ვერ გავუძელი. ამიტომაც გამიჩნდა ეს კუზი. დავდივარ, ძლივს დამაქვს ფეხები, ხანდახან, დღე ისე გავა, რომ ხმასაც არ ამოვიღებ. სულ მარტო ვარ, არავინ მყავს, ერთი ჭიქა წყალი რომ მომაწოდოს, ან გულის ტკივილი რომ გავუზიარო...“\n        დოდო კაკაბაძის ცხოვრება ნამდვილ კოშმარს ჰგავს... მარტოობაში სიკვდილი ემუქრება... ნათელი მოგონებები უბრალოდ არ აქვს - მხოლოდ გაჭირვება და ლუკმა პურისთვის ბრძოლა! მე-8 კლასიდან ავტომობილების ქარხანაში დაიწყო მუშაობა და დაივიწყა, რა არის ბედნიერება.\n         დოდო: მამინაცვალთან ერთად გავიზარდე, ძალიან გვიჭირდა. მამინაცვალი ავტომობილების ქარხანაში მუშაობდა, სახლში კი, ყველა ბინძური საქმის კეთება, ბავშვობიდან მე მიწევდა... ეს კონკიას ზღაპარს ჰგავს. მაგრამ, ჩემი ზღაპრის დასასრული არ არის ბედნიერი. არც უფლისწული ყოფილა, არც სასახლე... მხოლოდ ტანჯვა და ტკივილი. მაგრამ, ესეც არ არის ყველაზე დიდი საშინელება ჩემს ცხოვრებაში. ვინ მუშაობდა, ოჯახს ვინ ინახავდა?, - მუშაობდით კიდეც?\n         დოდო: 16 წლიდან! თან, რაღაც ფაბრიკაში კი არა. მხოლოდ 8 კლასი მაქვს დამთავრებული. მერე, დედამ მითხრა, რომ ოჯახს მარტო ვერ აუდიოდა და ჩემი დახმარება სჭირდებოდა. სწავლას თავი დავანებე. არადა, როგორ მინდოდა! უმცროს ძმას ვუვლიდი, სახლს, საქონელს. მერე, სამუშაოდ გამიშვეს რადგან, ფული არ გვყოფნიდა. მდივნის საქმე ავითვისე, მანქანაზე ბეჭდვა ვისწავლე, სამსახურში მოვეწყვე, სადაც 80 მანეთს მიხდიდნენ. მაგრამ, მამინაცვალმა თქვა, რომ ეს ცოტაა და ქუთაისის საავტომობილო ქარხანაში მომაწყო. მე, 16 წლის სიფრიფანა გოგო, ავტომობილის ნაწილებს ვაწყობდი, დგუშებს... იცით, რა მძიმეა? ყველა გიჟივით მიყურებდა. კაცივით ვმუშაობდი. 300 მანეთს მიხდიდნენ. დედა და მამინაცვალი კმაყოფილები იყვნენ. მთელ ხელფასს მათ ვაძლევდი. ვინმე ავად თუ გახდებოდა, ან დამატებითი სამუშაო თუ გამოჩნდებოდა, შეუცვლელი ვიყავი, მეუბნებოდნენ: „იმუშავე რა მოგივა, სახლში მაინც არავინ გელისო...“\n         - გისმენთ და ყელში ბურთი მეჩხირება... წარმომიდგენია, თავს როგორ გრძნობდით.", " დოდო: ეჰ, რომ მცოდნოდა, ასეთი საშინელი ხვედრი მელოდა - მარტოსული სიბერე... როდესაც არავინ გყავს ერთი ჭიქა წყლის მომწოდებელი, ხმის გამცემი, მთელი დღის განმავლობაში... ალბათ, სხვანაირად ვიცხოვრებდი. საკუთარ თავზე მეტს ვიფიქრებდი, სწავლას არ დავანებებდი თავს და ვირივით არ ვიმუშავებდი. ხანდახან, ჩუმად ამიღია კარაქი სუფრიდან, ხელებზე რომ წამესვა, ისეთი დაკოჟრილი მქონდა, დამსკდარი, სისხლი მდიოდა.\n          - მარტოობის გარდა, რა გაწუხებთ?\n           დოდო: ყველაფერი მტკივა, შვილო, აბსოლუტურად ყველაფერი! არ მახსოვს ეს ბრძნული სახელები. ამ კუზის გამო, სუნთქვა მიჭირს, ყველაფერი მტკივა: გული, კუჭი, ფეხები, ყველაფერი... განსაკუთრებით, სული... მე ხომ არავის, სულ არავის ვჭირდები. ხანდახან, დაწოლაც კი არ შემიძლია, თითქმის დამჯდარს მძინავს... იმის თავიც კი არ მაქვს, საშველად ვინმეს რომ დავუძახო. მეშინია, აი, ასე, დამჯდარი მოვკვდები, მეზობლები კი, მხოლოდ მეორე დღეს მიპოვნიან.\n         - მეუღლე", "    დოდო: მთელი ცხოვრება მარტო ვიყავი... რაც დედამ მეორე ოჯახი შექმნა, არავის ვუყვარდი. არ ვიცი, რას ნიშნავს სიყვარული. თითქოს, მხოლოდ მუშაობისთვის ვარ დაბადებული. ვერავინ მამჩნევდა, ჩვენი სახლის ყველაზე შორეულ კუთხე-კუნჭულში ვიმალებოდი, ჩუმად ვტიროდი, თვალებს ვხუჭავდი იმის იმედით, რომ ეს უბრალოდ საშინელი სიზმარია, თვალებს გავახელ და ეს კოშმარი გაქრება. კი, გავიზარდე, გავხდი ძლიერი, მაგრამ, სრულიად მარტო დავრჩი. არც ქმარი მყავს, არც შვილები, მყავს ნათესავები მაგრამ, მათ საკუთარი ცხოვრება აქვთ. მოხუცი, კუზიანი ქალი არავის სჭირდება.\n         - გამოდის, სულ არავინ გყავთ, რომ მოგეხმაროთ? მარტო როგორ უმკლავდებით ყველაფერს? ვიღაცამ ხომ უნდა გარეცხოს, ან საჭმელი მოამზადოს?\n        დოდო: ჯერჯერობით, როგორღაც ვუმკლავდები, ღმერთის წყალობით. ჩემი ხელით ვრეცხავ, ცივ წყალში... ხანდახან, საჭმელსაც ვამზადებ, ძალიან იშვიათად... მეზობლები მაწვდიან საჭმელს, ძალიან გულკეთილი ხალხია. ხან ერთი ნათესავის ოჯახში ვცხოვრობდი, ხან - მეორის, მერე, გადავწყვიტე, ჩემს სახლში გადმოსვლა. არ არის დასრულებული, არც ფანჯრებია ჩასმული, არც კარი. დავიძინებ მარტო, გავიღვიძებ და, ხან მეზობლის ქათამი მაზის, ხან მაწანწალა ძაღლი. ზაფხულში კიდე არა უშავს, სიცივე რომ მოვა, რა მეშველება? მოვკვდები, ალბათ. ავეჯიც კი არ მაქვს. აი, გული ასე ძალიან რის გამო მწყდება! 35 წელი, თავდაუზოგავად ვშრომობდი, თურმე საკუთარი თავისთვის კი არა, სხვებისთვის! ეჰ, ღმერთი ყველაფერს ხედავს.\n        - ძალიან გითანაგრძნობთ, დახმარებისთვის თუ მიმართეთ ვინმეს? მაგალითად, ადგილობრივ ხელისუფლებას?\n        დოდო: ვის არ მივწერე, როდესაც ჯერ კიდევ შემეძლო და ასე ძალიან არ მიკანკალებდა ხელები. რითაც შეუძლიათ, მეხმარებიან. ჩვენს რაიონში უამრავი ბავშვი შიმშილობს, როგორ წავართმევ პირიდან ლუკმას? პენსია კი, არაფერში მყოფნის.", "   - აქ რანაირად ცხოვრობთ, საერთოდ?\n        დოდო: აბა, რა ვქნა? თავზე ჭერი მაინც მაქვს. ბევრი ხატი მაქვს, ხშირად ვლოცულობ... მართალია საკუთარი სიტყვებით, მაგრამ მთელი გულით... ღმერთს ვევედრები, ყველას აშოროს მარტოობა...\n          - უცხო ადამიანების სიკეთის გჯერათ? \n          დოდო: რა თქმა უნდა... ძალიან კეთილი მეზობლები მყავს, შემოდიან, მკითხულობენ, საჭმელსაც მინაწილებენ. ვიცი, კეთილი ადამიანი ბევრია ამქვეყნად.\n        - თქვენ თქვით, რომ არასდროს გიოცნებიათ, და ახლა? ახლა თუ გაქვთ რაიმე ოცნება?\n         დოდო: მარტო ვარ, შვილო, სულ მარტო... იცით, რა საშინელებაა?\n        - თქვენი აზრით, პირველ რიგში რა გჭირდებათ?\n         დოდო: თავხედობაში ნუ ჩამომართმევთ, მაგრამ ზამთრის მოსვლამდე, სახლი მაქვს შესაკეთებელი. მჭირდება კარ-ფანჯარა... თავად გადახედეთ, არაფერი გამაჩნია. რაღაც ავეჯი მაინც მჭირდება. სასაცილოა, უკვე ორი საათია გელაპარაკებით ჩემს უბედურ ცხოვრებაზე. ალბათ, სიკვდილი უფრო მარტივი იქნებოდა, მაგრამ, სიცოცხლე ხომ ისეთი ტკბილია! განა რამდენი დამრჩენია, მინდა, უკანასკნელი წლები მაინც გავატარო ადამიანურად.\n         - როგორც ვხედავ, მაცივარი არ გაქვთ, საჭმელს სად ინახავთ?\n          დოდო: არსად. აი ამ კარადის ქვედა თაროზე ჭურჭელი მიდევს, ზედა თაროებზე - ტანსაცმელი. თუ საჭმელი მაქვს, იქვე ვინახავ. მაცივარი კარგი იქნებოდა, რა თქმა უნდა. ოღონდ, ძალიან, ძალიან პატარა. აი, სარეცხი მანქანა კი, მართლაც ძალიან მჭირდება... აღარ შემიძლია... ვინ გამირეცხავს? ხშირად მიწევს ზეწრების რეცხვა. ცივ წყალში გავავლებ და დავკიდებ, ხოლმე. აბა, რა ვქნა? სარეცხი ფხვნილის ნასახიც არ მაქვს.\n         - კარგია, დახმარებისთვის ჩვენ რომ მოგვმართეთ...\n         დოდო: ჩემმა მეზობელმა მოგმართათ. ძალიან მიხარია, რომ მოხვედით! ამდენ ხანს, არავინ დამლაპარაკებია, წლებია...\n         - ჩვენს ფონდს უამრავი კეთილი მეგობარი ჰყავს, დარწმუნებული ვარ, თქვენი გაცნობა მოუნდებათ!\n          დოდო: ძალიან გამიხარდება, ვინმეს თუ გავახსენდები... ღმერთმა ყველას მშვიდობა მისცეს! მთელი გულით გელით და გეძახით. თქვენთვის ვლოცულობ, ფონდის მეგობრებო!\n* * *", "     ნუ დავტოვებთ მარტოხელა მოხუცს უყურადღებოდ - ჩვენ, მთელი საქართველო, მისი შვილები და შვილიშვილები უნდა გავხდეთ და მასზე ვიზრუნოთ! მარტოსული სიბერე, უმწეობა, ეს ხომ, ყველაზე საშინელი ხვედრია. \n        დოდოს ყველანაირი ტანჯვა ხვდა წილად, რის წარმოდგენაც კი შეიძლება. იქნებ, სწორედ ჩვენ შევძლებთ, ვაჩუქოთ ნანატრი ბედნიერება? მოხუცებიც ხომ ბავშვებივით არიან - მათ მოფერება და სითბო, ადამიანური ურთიერთობა სჭირდებათ, რომ არაფერი ვთქვათ ნორმალურ საცხოვრებელ პირობებზე... მოდით, ერთად შევუმსუბუქოთ ცხოვრება საბრალო მოხუცს და შევახსენოთ, რა არის ბედნიერება! \n         ძალიან სჭირდება საკვები პროდუქტი, მედიკამენტები, საოჯახო ტექნიკა, ავეჯი და სახლის რემონტი. თუ ზამთრის მოსვლამდე კარ-ფანჯრის ჩაყენებას ვერ მოვასწრებთ, შეიძლება უბრალოდ გაიყინოს. წარმოგიდგენიათ?\n         შეგიძლიათ პირადად გაიცნოთ და შეძლებისდაგვარად გაუწიოთ მას დახმარება, უფალი დაგლოცავთ! და დაგაჯილდოვებთ! მისამართი: წყალტუბო, სოფელი ბანოჯა.\n ყოველ ჯერზე, როდესაც ვინმეს დახმარება შეგიძლიათ, უბრალოდ დაეხმარეთ და გაიხარეთ, რომ ღმერთი თქვენი მეშვეობით პასუხობს ვიღაცის ლოცვებს!\n გვჯერა, რომ ერთად ნამდვილად შევძლებთ მათ გადარჩენას!\n არ დაგავიწყდეთ ამ პოსტის გაზიარება, რათა თქვენმა მეგობრებმაც შეიტყონ ამ ოჯახის გასაჭირის შესახებ! ეს ძალიან მნიშვნელოვანია!\n\uD83D\uDCE9მეგობრებო, კიდევ ერთი თხოვნა გვაქვს თქვენთან: თუკი შეიტყობთ, რომ თქვენს ნაცნობს ან მეზობელს სჭირდება დახმარება, გთხოვთ, გამოიჩინოთ გულისხმიერება და მოგვწეროთ ამის შესახებ ელექტრონულ მისამართზე: office-fsp@fsp.ge", "\uD83D\uDE4Cჩვენი ფონდის ანგარიში:\n#GE15TB7194336080100003\n#GE42LB0115113036665000\n#GE64BG0000000470458000\n(დანიშნულება: დოდო კაკაბაძე)\n\uD83D\uDE4Cთანხის ჩარიცხვა ასევე შეგიძლიათ ჩვენი ვებ-გვერდის მეშვეობით https://chernovetskyifund.ge/ge/projects/967-kakabadze/\nასევე, თანხის ჩარიცხვა შესაძლებელია TBCpay და ExpressPay ტერმინალებიდან. მოძებნეთ ჩვენი ფონდი ქვეთავში “ქველმოქმედება“ (ფონდის დამატებით უფლება- მოვალეობებს შეგიძლიათ გაეცნოთ ბმულზე https://goo.gl/GY2Gus).\n         ერთად, ჩვენ უკვე ათასობით გაჭირვებულს დავეხმარეთ. გავუმართოთ ხელი ამ ოჯახსაც! ვინ იცის, იქნებ სრულიად უცხო ადამიანების დახმარება ოდესმე თავადაც დაგვჭირდეს?! რადგან არავინ იცის, რას გვიმზადებს ცხოვრება ხვალ!\n\uD83D\uDCCC შესანიშნავი სიახლე გვაქვს! ახლა შეგიძლიათ ჩვენი ბენეფიციარების ისტორიების წაკითხვა ინსტაგრამზე: https://www.instagram.com/chernovetskyi.fund/ და ტელეგრამზე: https://t.me/ChernovetskyiFund\n☎️ სპეციალურ ნომერზე: 0901 200 270 განხორციელებულ თქვენს მიერ მხოლოდ ერთ ზარს, ადამიანის სიცოცხლის გადარჩენა შეუძლია!\nდალოცვილები ყოფილიყავით!")

  val start = System.currentTimeMillis()
  val master = new WordCountMaster(arr)
  master.execute()
  val end = System.currentTimeMillis()
  println(s"multi threaded = ${end - start} count = ${master.getTotal}")

  val singleSt = System.currentTimeMillis()
  val count = arr.map(_.split(" ").length).sum
  val singleEnd = System.currentTimeMillis()
  println(s"single threaded = ${singleEnd - singleSt} count = $count")


}
